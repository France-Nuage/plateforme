stages:
  - build
  - sanity

include:
  - local: 'apps/api/.gitlab-ci.yml'

# Sanity check to allow merge if there is no pipeline at all on a Merge request
# Please refer here : https://gitlab.com/gitlab-org/gitlab/-/issues/334281
sanity_check_at_the_end:
  stage: sanity
  script:
    - echo "Sanity check passed, please refer to this issue https://gitlab.com/gitlab-org/gitlab/-/issues/334281 for more infos."
  rules:
    - if: $CI_PIPELINE_SOURCE == "merge_request_event" && $CI_MERGE_REQUEST_PIPELINE_ID == 1
      when: always
    - when: never